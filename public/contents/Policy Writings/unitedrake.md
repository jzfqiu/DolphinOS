# Overview of NSA Spyware UNITEDRAKE

*Jeff Qiu*

Developed by the NSA, UNITEDRAKE (UR) is a spyware system that serves as a platform for various functional modules. It consists of three parts: a client to be implanted on the computer of the person being spied on, a server (sometimes known as a listening post) that stores functional modules and communicate with the client, and a system management interface (SMI) that asynchronously issue client tasks to servers. To use it, the human agent queue various tasks, such as exfiltrating files, to the server. The client then periodically retrieves the tasks from the server and executes them one by one, returning the result to the server after finishing a task.

The UR client, on its own, does not perform any task except for communicating with the server. The client also needs to be implanted through other means as it does not have intrusion functions built in. However, once planted, the client can download plugins to execute various tasks. Several plugins made an appearance in a screenshot of plugin management tool: &quot;Exfil manager&quot; prepares files for exfiltration; &quot;Packet Capture&quot; monitors network traffic on the target machine; and &quot;Directory Monitor&quot; scans file directory to look for useful data. Some other plugins with more obscure names, such as &quot;FoggyBottom,&quot; are suspected of having the ability to capture keystrokes and discreetly turn on the infected computer&#39;s microphone and camera. With these plugins, UR can collect any data passing through or stored on the machine.

While the manual does not mention any specific dates or targets, other documents and research reveal that the spyware may have been widely deployed in European targets since 2008. A set of documents leaked by Snowden contains a spyware catalog published in 2008, in which another spyware called IRONCHEF mentioned UR as part of its downstream applications.

NSA has likely been actively deploying UR since then, if not earlier. In a separate investigation in 2014, private security firms and journalists found spyware embedded in the computer system of the European Parliament and a Belgium telecom company. Investigators conclude that the sophistication of the spyware, which they named &quot;Regin,&quot; points to it being the work of NSA and its British counterpart GCHQ. There is no direct public evidence that links Regin with UR, and the intelligence agencies denied any involvement. However, Regin&#39;s customizable spying capability and communication protocol exactly match UR&#39;s. It is unlikely that the NSA developed two separate software serving the same functions.

The system is authorized to collect data base on the 1978 Foreign Intelligence Surveillance Act (FISA). In the context of electronic surveillance, FISA regulates the targeted surveillance of properties belonging to a foreign power, authorized by either a Foreign Intelligence Surveillance Court (FISC) order or order from the president.

UR has FISA compliance built into the system. Each client is labeled with a FISA expiration date in the server&#39;s database, which likely comes from the court order authorizing the operation. After the expiration date, the server will automatically place the client in a &quot;deny list&quot; and reject any connection request from the client. However, the record of expired clients will remain in the server unless the agent specifically deletes it. Such a design probably facilitates future spying capability in case the authorization is extended.

UR&#39;s capability raises significant concerns regarding individual privacy. The system is built to enable both targeted surveillance and mass surveillance. Each server is designed to take command from multiple interfaces and can service an unlimited number of clients. The server also supports &quot;batch mode,&quot; in which a large number of tasks can be issued to one or multiple clients with a single command. These features enable almost effortless collections of personal data on a large scale. We do not know whether the NSA has used UR in any mass surveillance program such as PRISM, but with the help of various software (e.g., [FOXACID](https://www.aclu.org/foia-document/foxacid)) and hardware (e.g., [NIGHTSTAND](https://www.aclu.org/foia-document/nsas-spy-catalogue)) tools, NSA can easily infect a large number of computers with UR clients.

Even if a mass surveillance program is cut short by policy oversight, botched targeted surveillance can spell disaster for individuals involved. One such example is Tony Fullman, a New Zealand democratic activist whose bank statement and job application email appear in the trove of leaked NSA documents. Suspected to plot violence against the Fuji government, Fullman was spied upon by the NSA at the New Zealand intelligence agency&#39;s request.

While the suspicion turned out to be completely false and the investigation dropped, Fullman&#39;s most private information has been passed around between the NSA and New Zealand government, which eventually ended up in public with Snowden&#39;s disclosure. Fullman&#39;s case demonstrated that such an invasive tool endangers everyone in the world who is not a US citizen, not just people working on behalf of foreign governments.

In addition, the spyware could circulate within cybercriminals and fuel cyber terrorism. The client program has already been obtained and published by private security researchers in the previously mentioned investigation. Although the rest of the command structure is still in NSA&#39;s hands, it would only be a matter of time until bad actors reverse-engineer the program, build the rest of the system, and conduct targeted espionage of their own. Leaving such advanced tools in public space is a considerable privacy problem for individuals and increases the risk of cyber espionage and ransomware attack against businesses. In 2017, an NSA-developed exploit known as EternalBlue was leaked by Shadow Broker to the public. The exploit was quickly picked up and developed by North Korea, Russia, and China, with North Korea and Russia developing the WannaCry and NotPetya ransomware, causing billions of dollars of damage in European businesses. Given the speed at which state-sponsored hackers repurposed the leaked exploit, spyware variants developed from UR may already be in action.

[https://www.aclu.org/foia-document/unitedrake-manual](https://www.aclu.org/foia-document/unitedrake-manual)

[https://www.zdnet.com/article/shadowbrokers-return-with-the-release-of-unitedrake-exploit/](https://www.zdnet.com/article/shadowbrokers-return-with-the-release-of-unitedrake-exploit/)

[https://www.aclu.org/foia-document/nsas-spy-catalogue](https://www.aclu.org/foia-document/nsas-spy-catalogue)

[https://theintercept.com/2014/11/24/secret-regin-malware-belgacom-nsa-gchq/](https://theintercept.com/2014/11/24/secret-regin-malware-belgacom-nsa-gchq/)

[https://www.law.cornell.edu/uscode/text/50/1802](https://www.law.cornell.edu/uscode/text/50/1802)

[https://theintercept.com/2016/08/14/nsa-gcsb-prism-surveillance-fullman-fiji/](https://theintercept.com/2016/08/14/nsa-gcsb-prism-surveillance-fullman-fiji/)

[https://www.washingtonpost.com/business/technology/nsa-officials-worried-about-the-day-its-potent-hacking-tool-would-get-loose-then-it-did/2017/05/16/50670b16-3978-11e7-a058-ddbb23c75d82\_story.html](https://www.washingtonpost.com/business/technology/nsa-officials-worried-about-the-day-its-potent-hacking-tool-would-get-loose-then-it-did/2017/05/16/50670b16-3978-11e7-a058-ddbb23c75d82_story.html)